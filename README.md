# Домашнее задание к занятию «Резервное копирование баз данных»

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 
Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

 Необходимо настроить полное резервное копирование БД раз в сутки.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

Можно использовать полное резервное копирование БД раз в сутки и периодически настроенный инкрементный бэкап (каждый час).

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

Да, это возможно, если внедрена одна из следующих технологий для работы с базами данных:
- Репликация баз данных; 
- Кластеризация;
- Failover-системы;
- Использование облачных решений;
- Горячее резервирование (Hot Standby).


### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

**pg_dump -U username -F c -b -v -f "backup_file.backup" database_name**

где,

-U username: имя пользователя базы данных.

-F c: формат резервной копии (c - custom, что позволяет использовать pg_restore для восстановления).

-b: включает большие объекты (large objects) в резервную копию.

-v: выводит подробную информацию о процессе резервного копирования.

-f "backup_file.backup": имя файла, в который будет сохранена резервная копия.

database_name: имя базы данных, которую нужно сохранить.

**pg_restore -U username -d database_name -v "backup_file.backup"**

где,

-d database_name: имя базы данных, в которую будет восстановлена резервная копия.

-v: выводит подробную информацию о процессе восстановления.


2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

Да, используя планировщик заданий Linux Cron и Bash скрипты.

 
### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.

Создаем полное резервное копирование базы данных:

**mysqldump --flush-logs --single-transaction --all-databases > full_backup.sql**

Включаем двоичные журналы:

**log-bin=mysql-bin**

Копируем соответствующие двоичные журналы:

**cp /var/lib/mysql/mysql-bin.000001 /path/to/backup/**

Восстанавливаем полную резервную копию БД, а затем применяем все двоичные журналы, которые были созданы после этого:

**mysql < full_backup.sql**

**mysqlbinlog /path/to/backup/mysql-bin.000001 | mysql**
  



3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

Использование реплики базы данных предоставляет множество преимуществ, особенно в сценариях, требующих высокой доступности, минимизации времени простоя и обеспечения непрерывного доступа к данным.

